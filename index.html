<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>재고조사 - CSV 업로드</title>
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <header>
      <div class="container">
        <h1>📦 재고조사 시스템</h1>
        <nav>
          <a href="index.html" class="active">CSV 업로드</a>
          <a href="inventory.html">재고조사</a>
          <a href="download.html">CSV 다운로드</a>
        </nav>
      </div>
    </header>

    <main class="container">
      <div class="card">
        <h2>제품 목록 CSV 업로드</h2>
        <p class="text-muted mb-3">
          제품번호(A열), 제품명(B열), 수량(C열) 형식의 CSV 파일을 업로드하세요.
        </p>

        <div id="dropzone" class="dropzone">
          <div class="dropzone-icon">📄</div>
          <h3>CSV 파일을 드래그하거나 클릭하세요</h3>
          <p class="text-muted">지원 형식: .csv</p>
          <input
            type="file"
            id="fileInput"
            accept=".csv"
            style="display: none"
          />
        </div>

        <div id="fileInfo" class="hidden mt-2">
          <div class="alert alert-info">
            <span>📁</span>
            <span id="fileName"></span>
          </div>
        </div>

        <div id="uploadProgress" class="hidden">
          <div class="progress">
            <div id="progressBar" class="progress-bar" style="width: 0%"></div>
          </div>
          <p class="text-center mt-1" id="progressText">업로드 중...</p>
        </div>

        <div id="uploadResult" class="hidden mt-2"></div>

        <div class="mt-3">
          <button id="uploadBtn" class="btn btn-primary" disabled>
            <span>⬆️</span>
            <span>데이터베이스에 업로드</span>
          </button>
        </div>
      </div>

      <div class="card">
        <h3>💡 사용 안내</h3>
        <ol style="padding-left: 20px; color: var(--text-secondary)">
          <li>CSV 파일은 헤더(제목행)가 포함되어야 합니다</li>
          <li>A열: 제품번호, B열: 제품명, C열: 수량</li>
          <li>중복된 제품번호가 있으면 자동으로 덮어씁니다</li>
          <li>약 2,000개의 제품을 한 번에 업로드할 수 있습니다</li>
          <li>업로드 후 "재고조사" 페이지에서 수량을 입력하세요</li>
        </ol>
      </div>
    </main>

    <!-- Supabase JS SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- PapaParse for CSV parsing -->
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <!-- Config - Inline to avoid loading issues -->
    <script>
      // Supabase 설정
      const SUPABASE_URL = "https://rgfvubjdjyuitprsagkx.supabase.co";
      const SUPABASE_ANON_KEY =
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJnZnZ1Ympkanl1aXRwcnNhZ2t4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg2NDEzODEsImV4cCI6MjA4NDIxNzM4MX0.yNmb9v4ncLlOaMZ52-yu9EJ3CLV0yI_AGE_m0fX3SOk";

      // Supabase 클라이언트 초기화
      const supabaseClient = window.supabase.createClient(
        SUPABASE_URL,
        SUPABASE_ANON_KEY
      );

      // 테이블 이름
      const PRODUCTS_TABLE = "products";
    </script>
    <!-- Upload Logic -->
    <script src="js/upload.js"></script>
  </body>
</html>
